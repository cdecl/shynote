# SHYNOTE ë°ì´í„° íë¦„ ë¶„ì„

## ğŸ“‹ ëª©ì°¨

- [ì•„í‚¤í…ì²˜ ê°œìš”](#ì•„í‚¤í…ì²˜-ê°œìš”)
- [ì£¼ìš” ì•¡ì…˜ë³„ ë°ì´í„° íë¦„](#ì£¼ìš”-ì•¡ì…˜ë³„-ë°ì´í„°-íë¦„)
  - [1. ì´ˆê¸°í™” ë° ë¡œë“œ](#1-ì´ˆê¸°í™”-ë°-ë¡œë“œ-ì´ˆê¸°-ì§„ì…-ì‹œ)
  - [2. ë…¸íŠ¸ ìƒì„± (CREATE)](#2-ë…¸íŠ¸-ìƒì„±-create)
  - [3. ë…¸íŠ¸ ìˆ˜ì • (UPDATE)](#3-ë…¸íŠ¸-ìˆ˜ì •-update)
  - [4. ë…¸íŠ¸ ì‚­ì œ (DELETE)](#4-ë…¸íŠ¸-ì‚­ì œ-delete)
  - [5. í´ë” ê´€ë¦¬ (CRUD)](#5-í´ë”-ê´€ë¦¬-crud)
  - [6. ë™ê¸°í™” ì „ëµ (SYNC)](#6-ë™ê¸°í™”-ì „ëµ-sync)
  - [7. ì˜¤í”„ë¼ì¸ ì§€ì›](#7-ì˜¤í”„ë¼ì¸-ì§€ì›)
  - [8. ê²ŒìŠ¤íŠ¸ ëª¨ë“œ](#8-ê²ŒìŠ¤íŠ¸-ëª¨ë“œ)
- [ë°ì´í„° ëª¨ë¸](#ë°ì´í„°-ëª¨ë¸)
- [ì£¼ìš” ë™ê¸°í™” ë©”ì»¤ë‹ˆì¦˜](#ì£¼ìš”-ë™ê¸°í™”-ë©”ì»¤ë‹ˆì¦˜)
- [í˜„í™© ìš”ì•½](#í˜„í™©-ìš”ì•½)

---

## ì•„í‚¤í…ì²˜ ê°œìš”

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   UI Layer  â”‚ (Vue.js Reactive State)
â”‚   Memory    â”‚ â† notes[], folders[], selectedNote
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”œâ”€â–¶ Local Storage (ì‚¬ìš©ì ì„¤ì •: ë‹¤í¬ëª¨ë“œ, í°íŠ¸ í¬ê¸° ë“±)
       â”‚
       â”œâ”€â–¶ IndexedDB (LocalDB)
       â”‚   - notes store (sync_status: dirty/synced)
       â”‚   - folders store (sync_status: dirty/synced)
       â”‚   - pending_logs (ë™ê¸°í™” ëŒ€ê¸°ì—´)
       â”‚
       â””â”€â–¶ Backend API (FastAPI + SQLAlchemy)
           - PostgreSQL/SQLite
           - OAuth 2.0 ì¸ì¦
```

**íŠ¹ì§•:**
- **Local-First ì•„í‚¤í…ì²˜**: ëª¨ë“  ë°ì´í„°ê°€ ë¨¼ì € IndexedDBì— ì €ì¥
- **Optimistic UI**: ë¡œì»¬ ë°ì´í„°ë¥¼ ì¦‰ì‹œ í‘œì‹œ í›„ ë°±ê·¸ë¼ìš´ë“œ ë™ê¸°í™”
- **ì˜¤í”„ë¼ì¸ ì§€ì›**: ë„¤íŠ¸ì›Œí¬ ì—°ê²° ì—†ì´ë„ ëª¨ë“  ê¸°ëŠ¥ ì‘ë™

---

## ì£¼ìš” ì•¡ì…˜ë³„ ë°ì´í„° íë¦„

### 1. ì´ˆê¸°í™” ë° ë¡œë“œ (ì´ˆê¸° ì§„ì… ì‹œ)

#### ì¸ì¦ ì²´í¬
```javascript
checkAuth() â†’
  â”œâ”€ localStorageì—ì„œ í† í° í™•ì¸
  â”œâ”€ fetchUserProfile() â†’ /auth/me
  â””â”€ currentUserId.value ì„¤ì •
```

#### ë°ì´í„° ë¡œë“œ (ìµœì í™”ëœ ìˆœì„œ)
```javascript
onMounted() â†’
  â”œâ”€ fetchUserProfile()
  â”‚
  â”œâ”€ fetchFolders()
  â”‚   â”œâ”€ 1. LocalDB.getAllFolders(uid) â†’ ì¦‰ì‹œ UI ì—…ë°ì´íŠ¸
  â”‚   â””â”€ 2. authenticatedFetch('/api/folders') â†’ ë°±ê·¸ë¼ìš´ë“œ
  â”‚       â””â”€ LocalDB.saveFoldersBulk() â†’ ë³‘í•©
  â”‚
  â””â”€ fetchNotes()
      â”œâ”€ 1. LocalDB.getAllNotes(uid) â†’ ì¦‰ì‹œ UI ì—…ë°ì´íŠ¸ (loading: false)
      â””â”€ 2. authenticatedFetch('/api/notes') â†’ ë°±ê·¸ë¼ìš´ë“œ
          â””â”€ LocalDB.saveNotesBulk() â†’ ì¶©ëŒ ê°ì§€ í›„ ë³‘í•©
```

**íŠ¹ì§•:**
- **Optimistic UI**: ë¡œì»¬ ë°ì´í„°ë¥¼ ë¨¼ì € í‘œì‹œ
- **ë°±ê·¸ë¼ìš´ë“œ ë™ê¸°í™”**: ì„œë²„ ë°ì´í„°ë¥¼ ë¹„ë™ê¸°ë¡œ ê°€ì ¸ì™€ ë³‘í•©
- **ì¶©ëŒ ê°ì§€**: `content_hash` ë¹„êµë¡œ ì¶©ëŒ ë°œê²¬ ì‹œ MergeView í‘œì‹œ

---

### 2. ë…¸íŠ¸ ìƒì„± (CREATE)

```javascript
createNote() â†’
  â”œâ”€ 1. uuidv7()ë¡œ UUID v7 ìƒì„± (ì‹œê°„ ìˆœì„œ ë³´ì¥)
  â”œâ”€ 2. content_hash ê³„ì‚°: SHA-256(id:title:content:folder_id)
  â”œâ”€ 3. LocalDB.saveNote(newNote, 'CREATE')
  â”‚   â”œâ”€ notes storeì— ì €ì¥ (sync_status: 'dirty')
  â”‚   â””â”€ pending_logsì— {action: 'CREATE', entity: 'note'} ì¶”ê°€
  â”œâ”€ 4. notes.value.unshift(newNote) â†’ UI ì—…ë°ì´íŠ¸
  â””â”€ 5. ë°±ê·¸ë¼ìš´ë“œ: syncWorker()ê°€ ë™ê¸°í™”
      â””â”€ POST /api/notes â†’ ë¡œê·¸ ì‚­ì œ í›„ markNoteSynced()
```

**ë°ì´í„° êµ¬ì¡°:**
```javascript
{
  id: "0190xxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",  // UUID v7
  title: "2026-01-01 14:30",
  content: "",
  content_hash: "abc123...",                   // SHA-256
  folder_id: null,
  user_id: "xxx",
  sync_status: "dirty",                        // IndexedDBì—ì„œë§Œ ì‚¬ìš©
  local_updated_at: "2026-01-01T..."          // IndexedDBì—ì„œë§Œ ì‚¬ìš©
}
```

---

### 3. ë…¸íŠ¸ ìˆ˜ì • (UPDATE)

```javascript
// ì‚¬ìš©ìê°€ ì—ë””í„°ì—ì„œ íƒ€ì´í•‘
EditorView.updateListener â†’
  â”œâ”€ selectedNote.value.content = update.state.doc.toString()
  â””â”€ debouncedUpdate() (1ì´ˆ ë””ë°”ìš´ìŠ¤)
      â”œâ”€ content_hash ì¬ê³„ì‚°
      â”œâ”€ LocalDB.saveNote(note, 'UPDATE')
      â”‚   â”œâ”€ notes store ì—…ë°ì´íŠ¸ (sync_status: 'dirty')
      â”‚   â””â”€ pending_logsì— {action: 'UPDATE'} ì¶”ê°€
      â””â”€ statusMessage.value = 'Save Complete'
```

**ë°±ê·¸ë¼ìš´ë“œ ë™ê¸°í™”:**
```javascript
syncWorker() (5ì´ˆ ê°„ê²©) â†’
  â”œâ”€ LocalDB.getPendingLogs()
  â”œâ”€ ì¤‘ë³µ ì œê±° (CREATE + UPDATE â†’ CREATE)
  â”œâ”€ ì •ë ¬ (í´ë” ë¨¼ì € â†’ ë…¸íŠ¸)
  â””â”€ ê° ë¡œê·¸ë§ˆë‹¤:
      â”œâ”€ PUT /api/notes/{id} (body: {title, content, folder_id, is_pinned})
      â”œâ”€ ì„±ê³µ ì‹œ: LocalDB.removeLog() + markNoteSynced()
      â””â”€ ì‹¤íŒ¨ ì‹œ: ì¬ì‹œ íì— ìœ ì§€
```

**ìê°€ ì¹˜ìœ  ë©”ì»¤ë‹ˆì¦˜:**
```javascript
// PUT ì‹¤íŒ¨ 404 ì‹œ â†’ POSTë¡œ ì¬ì‹œë„ (ë³µêµ¬ ë¡œì§)
if (response.status === 404 && method === 'PUT') {
  // ì—”í‹°í‹°ê°€ ì„œë²„ì— ì—†ìœ¼ë©´ CREATEë¡œ ì¬ì‹œë„
  await authenticatedFetch('/api/notes', {method: 'POST', ...})
}
```

---

### 4. ë…¸íŠ¸ ì‚­ì œ (DELETE)

```javascript
deleteNote(noteId) â†’
  â”œâ”€ LocalDB.deleteNote(noteId)
  â”‚   â”œâ”€ notes storeì—ì„œ ì‚­ì œ
  â”‚   â””â”€ pending_logsì— {action: 'DELETE'} ì¶”ê°€
  â”œâ”€ notes.value = notes.value.filter(n => n.id !== noteId) â†’ UI ì—…ë°ì´íŠ¸
  â””â”€ ë°±ê·¸ë¼ìš´ë“œ: DELETE /api/notes/{noteId}
      â””â”€ ì„±ê³µ ì‹œ: ë¡œê·¸ ì‚­ì œ (404ë„ ì„±ê³µìœ¼ë¡œ ì²˜ë¦¬)
```

**íœ´ì§€í†µ ë™ì‘:**
```javascript
// ì‹¤ì œ ì‚­ì œ ëŒ€ì‹  í´ë” ì´ë™
moveToTrash(note) â†’
  â”œâ”€ note.folder_id = TRASH_FOLDER_ID  // "trash-uuid..."
  â”œâ”€ LocalDB.saveNote(note, 'UPDATE')
  â””â”€ UIì—ì„œ íœ´ì§€í†µ í´ë”ë¡œ í•„í„°ë§
```

---

### 5. í´ë” ê´€ë¦¬ (CRUD)

#### ìƒì„±
```javascript
createFolder() â†’
  â”œâ”€ uuidv7()ë¡œ ID ìƒì„±
  â”œâ”€ LocalDB.saveFolder(folder, 'CREATE')
  â””â”€ folders.value.push(folder)
```

#### ì´ë¦„ ë³€ê²½
```javascript
updateFolderName(folderId, newName) â†’
  â”œâ”€ folder.name = newName
  â”œâ”€ LocalDB.saveFolder(folder, 'UPDATE')
  â””â”€ PUT /api/folders/{folderId}
```

#### ì‚­ì œ
```javascript
deleteFolder(folderId) â†’
  â”œâ”€ LocalDB.deleteFolderAndNotes(folderId, noteIds)
  â”‚   â”œâ”€ í´ë” ì‚­ì œ
  â”‚   â””â”€ ì—°ê´€ ë…¸íŠ¸ ì „ì²´ ì‚­ì œ + DELETE ë¡œê·¸ ìƒì„±
  â””â”€ DELETE /api/folders/{folderId}
      â””â”€ ì„œë²„ì—ì„œ cascade deleteë¡œ ë…¸íŠ¸ë„ ì‚­ì œ
```

---

### 6. ë™ê¸°í™” ì „ëµ (SYNC)

#### í’€ (Pull) ì „ëµ
```javascript
fetchNotes() â†’
  â”œâ”€ ì„œë²„ì—ì„œ ì „ì²´ ë…¸íŠ¸ ê°€ì ¸ì˜´
  â”œâ”€ SHA-256 í•´ì‹œ ê³„ì‚°: hash(id:title:content:folder_id)
  â”œâ”€ LocalDB.saveNotesBulk(serverNotes)
  â”‚   â”œâ”€ sync_status === 'dirty'ì¸ í•­ëª©ì€ ê±´ë„ˆëœ€ (ì¶©ëŒ ë°©ì§€)
  â”‚   â””â”€ content_hashê°€ ê°™ìœ¼ë©´ ì—…ë°ì´íŠ¸ ìƒëµ (ìµœì í™”)
  â””â”€ ì¶©ëŒ ê°ì§€:
      â”œâ”€ local.sync_status === 'dirty' AND
      â”œâ”€ local.content_hash !== server.content_hash
      â””â”€ enterConflictMode(local, server) â†’ MergeView í‘œì‹œ
```

#### í‘¸ì‹œ (Push) ì „ëµ
```javascript
syncWorker() (5ì´ˆ ê°„ê²©, ì˜¨ë¼ì¸ ì‹œ) â†’
  â”œâ”€ LocalDB.getPendingLogs()
  â”œâ”€ ë¡œê·¸ ì¤‘ë³µ ì œê±° (CREATE í›„ UPDATE = CREATE)
  â”œâ”€ ì˜ì¡´ì„± ì •ë ¬: í´ë” ë¨¼ì € â†’ ë…¸íŠ¸ ë‚˜ì¤‘
  â””â”€ ìˆœì°¨ì  ì „ì†¡:
      â”œâ”€ ì„±ê³µ: ë¡œê·¸ ì‚­ì œ + markSynced()
      â”œâ”€ ì‹¤íŒ¨: íì— ìœ ì§€ (ë‹¤ìŒ ì£¼ê¸°ì— ì¬ì‹œë„)
      â””â”€ 404 PUT â†’ POSTë¡œ ë³µêµ¬ ì‹œë„
```

#### ì¶©ëŒ í•´ê²°
```javascript
resolveConflict(action) â†’
  â”œâ”€ 'use_local':
  â”‚   â””â”€ updateNote() â†’ ì„œë²„ì— ë¡œì»¬ ë²„ì „ ê°•ì œ ì „ì†¡
  â””â”€ 'use_server':
      â”œâ”€ localNote.title = serverNote.title
      â”œâ”€ localNote.content = serverNote.content
      â”œâ”€ LocalDB.saveNote(localNote, {sync_status: 'synced'})
      â””â”€ UI ì—…ë°ì´íŠ¸
```

---

### 7. ì˜¤í”„ë¼ì¸ ì§€ì›

#### Service Worker ì „ëµ
```javascript
// sw.js
â”œâ”€ CRITICAL_ASSETS ìºì‹± (index.html, app.js, local_db.js ë“±)
â”œâ”€ EXTERNAL_ASSETS ìºì‹± (Vue, CodeMirror, Tailwind ë“±)
â””â”€ Fetch ì´ë²¤íŠ¸:
    â”œâ”€ API ìš”ì²­ ê±´ë„ˆëœ€ (/api/, /auth/)
    â”œâ”€ ìºì‹œ íˆíŠ¸ â†’ ìºì‹œ ë°˜í™˜
    â”œâ”€ ë„¤íŠ¸ì›Œí¬ ì‹¤íŒ¨ â†’ '/' í´ë°±
    â””â”€ ê¸°ë³¸: ìºì‹œ â†’ ë„¤íŠ¸ì›Œí¬ â†’ ìºì‹œ ì—…ë°ì´íŠ¸
```

#### ì˜¨ë¼ì¸/ì˜¤í”„ë¼ì¸ ê°ì§€
```javascript
window.addEventListener('online') â†’
  â”œâ”€ isOnline.value = true
  â”œâ”€ startSync() â†’ syncWorker() + setInterval(5s)
  â””â”€ fetchFolders(), fetchNotes() â†’ ì „ì²´ í’€

window.addEventListener('offline') â†’
  â”œâ”€ isOnline.value = false
  â””â”€ stopSync() â†’ clearInterval()
```

---

### 8. ê²ŒìŠ¤íŠ¸ ëª¨ë“œ

```javascript
if (token === 'guest') â†’
  â”œâ”€ authenticatedFetch ì¸í„°ì…‰íŠ¸
  â””â”€ guestStore (ì¸ë©”ëª¨ë¦¬ ëª¨ì˜ DB):
      â”œâ”€ user: {id: 'guest', email: 'guest@shynote.app'}
      â”œâ”€ notes: [...]
      â””â”€ folders: [...]
```

**íŠ¹ì§•:**
- IndexedDB ì‚¬ìš©í•˜ì§€ ì•ŠìŒ
- ì„œë²„ ìš”ì²­í•˜ì§€ ì•ŠìŒ (ì™„ì „ ë¡œì»¬)
- ìƒˆë¡œê³ ì¹¨ ì‹œ ë°ì´í„° ì†Œë©¸

---

## ë°ì´í„° ëª¨ë¸

### IndexedDB ìŠ¤í‚¤ë§ˆ (local_db.js:6-33)

```
DB_NAME: 'SHYNOTE_VAULT'
DB_VERSION: 8

ObjectStores:
  1. notes
     - keyPath: 'id'
     - indexes: folder_id, updated_at, sync_status, user_id

  2. folders
     - keyPath: 'id'
     - indexes: user_id

  3. pending_logs
     - keyPath: 'id' (autoIncrement)
     - indexes: created_at
     - structure: {action, entity, entity_id, payload, created_at}
```

### Backend ìŠ¤í‚¤ë§ˆ (models.py)

```python
User:
  id (String, PK)
  email (String, unique)
  provider (String)  # "google"
  is_dark_mode (Boolean)
  view_mode (String)  # "edit", "split", "preview"

Folder:
  id (String, PK)
  name (String)
  user_id (String, FK)

Note:
  id (String, PK)
  title (String)
  content (Text)
  folder_id (String, FK, nullable)
  user_id (String, FK)
  share_id (String, unique, nullable)
  is_shared (Boolean)
  is_pinned (Boolean)
  created_at (DateTime)
  updated_at (DateTime)
```

---

## ì£¼ìš” ë™ê¸°í™” ë©”ì»¤ë‹ˆì¦˜

### í•´ì‹œ ê¸°ë°˜ ë³€ê²½ ê°ì§€
```javascript
const hashBase = `${note.id}:${note.title}:${note.content || ''}:${note.folder_id || 'null'}`
note.content_hash = await shynote_hash(hashBase)  // SHA-256
```

### ìƒíƒœ ê´€ë¦¬
- `sync_status: 'dirty'` â†’ ë¡œì»¬ì—ì„œ ìˆ˜ì •ë¨, ë™ê¸°í™” í•„ìš”
- `sync_status: 'synced'` â†’ ì„œë²„ì™€ ë™ê¸°í™”ë¨

### ë¡œê·¸ ê¸°ë°˜ ë™ê¸°í™”
```javascript
// pending_logs ì˜ˆì‹œ
{
  id: 1,
  action: 'UPDATE',
  entity: 'note',
  entity_id: 'uuid-v7-here',
  payload: {title: 'New Title', content: '...', folder_id: 'folder-uuid'},
  created_at: '2026-01-01T14:30:00Z'
}
```

### ìë™ ë³µêµ¬
- PUT 404 â†’ POST ì¬ì‹œë„ (ì„œë²„ì— ì—†ëŠ” ê²½ìš°)
- í´ë” â†’ ë…¸íŠ¸ ìˆœì„œ ì „ì†¡ (ì˜ì¡´ì„± ë³´ì¥)

---

## í˜„í™© ìš”ì•½

| êµ¬ì„± ìš”ì†Œ | ìƒíƒœ | ì„¤ëª… |
|---------|------|------|
| ë©”ëª¨ë¦¬ ê°ì²´ (Vue) | âœ… ì™„ì „ | notes[], folders[], selectedNote ë“± ë°˜ì‘í˜• ìƒíƒœ |
| IndexedDB | âœ… ì™„ì „ | Local-first ì•„í‚¤í…ì²˜, ì˜¤í”„ë¼ì¸ ì§€ì› |
| Backend API | âœ… ì™„ì „ | FastAPI + PostgreSQL/SQLite |
| ë™ê¸°í™” (Sync) | âœ… ì™„ì „ | Pull/Push ì „ëµ, ì¶©ëŒ í•´ê²°, ìê°€ ì¹˜ìœ  |
| ì˜¤í”„ë¼ì¸ ì§€ì› | âœ… ì™„ì „ | Service Worker, ì˜¨ë¼ì¸/ì˜¤í”„ë¼ì¸ ê°ì§€ |
| ê²ŒìŠ¤íŠ¸ ëª¨ë“œ | âœ… ì™„ì „ | ì¸ë©”ëª¨ë¦¬ ë°±ì—”ë“œ ëª¨ì˜ |
# SHYNOTE ë°ì´í„° íë¦„ ASCII ë‹¤ì´ì–´ê·¸ë¨

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                     SHYNOTE ë°ì´í„° íë¦„ ì•„í‚¤í…ì²˜                          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        [ë¸Œë¼ìš°ì € ë ˆì´ì–´]                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   UI Layer   â”‚â—€â”€â”€â”€â–¶â”‚  Vue State   â”‚â—€â”€â”€â”€â–¶â”‚   CodeMirror Editor          â”‚
â”‚  (HTML/CSS)  â”‚     â”‚  (Reactive)  â”‚     â”‚   (Markdown Editor)          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚  Memory Objects        â”‚
                   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                   â”‚ â€¢ notes[]             â”‚
                   â”‚ â€¢ folders[]           â”‚
                   â”‚ â€¢ selectedNote        â”‚
                   â”‚ â€¢ isDarkMode          â”‚
                   â”‚ â€¢ isSyncing           â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                               â”‚                 â”‚
                               â–¼                 â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ localStorage  â”‚    â”‚ IndexedDB    â”‚
                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                    â”‚ â€¢ Settings   â”‚    â”‚ â€¢ notes      â”‚
                    â”‚   - DarkMode â”‚    â”‚ â€¢ folders    â”‚
                    â”‚   - FontSize â”‚    â”‚ â€¢ logs       â”‚
                    â”‚   - ViewMode â”‚    â”‚ â€¢ sync_statusâ”‚
                    â”‚ â€¢ User ID    â”‚    â”‚   dirty/syncedâ”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                                â”‚
                                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        [ë„¤íŠ¸ì›Œí¬ ë ˆì´ì–´]                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Service      â”‚â—€â”€â”€â”€â–¶â”‚   AuthenticatedFetch         â”‚â—€â”€â”€â”€â–¶â”‚  FastAPI     â”‚
â”‚ Worker       â”‚     â”‚   (API Calls)               â”‚     â”‚  Backend     â”‚
â”‚ (PWA Cache)  â”‚     â”‚                              â”‚     â”‚              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚ â€¢ GET  /api/notes           â”‚     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚ â€¢ POST /api/notes                  â”‚
                     â”‚ â€¢ PUT  /api/notes/{id}            â”‚
                     â”‚ â€¢ DELETE /api/notes/{id}           â”‚
                     â”‚ â€¢ GET  /api/folders               â”‚
                     â”‚ â€¢ POST/PUT/DELETE /api/folders     â”‚
                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                          â”‚
                                                          â–¼
                                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                            â”‚   Database            â”‚
                                            â”‚   (PostgreSQL/SQLite) â”‚
                                            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                                            â”‚ â€¢ users               â”‚
                                            â”‚ â€¢ folders             â”‚
                                            â”‚ â€¢ notes               â”‚
                                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                        1. ë…¸íŠ¸ ìƒì„± (CREATE)                            â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ User    â”‚ í´ë¦­ "New Note"
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ createNote()                                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. uuidv7() â†’ "0190xxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx"               â”‚
â”‚ 2. content_hash = SHA256(id:title:content:folder_id)              â”‚
â”‚ 3. newNote = {id, title, content, content_hash, sync_status:'dirty'}â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚                                                     â”‚
     â–¼                                                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ LocalDB.saveNote()  â”‚                          â”‚ UI ì—…ë°ì´íŠ¸         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                          â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ notes store       â”‚                          â”‚ notes.unshift(note) â”‚
â”‚   â†’ PUT (dirty)     â”‚                          â”‚ selectedNote=note   â”‚
â”‚ â€¢ pending_logs      â”‚                          â”‚ rightPanelMode='edit'â”‚
â”‚   â†’ ADD 'CREATE'    â”‚                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ [ë°±ê·¸ë¼ìš´ë“œ]
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ syncWorker() (5ì´ˆ ê°„ê²©)                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. pending_logsì—ì„œ 'CREATE' ë¡œê·¸ í™•ì¸                              â”‚
â”‚ 2. POST /api/notes {id, title, content, folder_id}                â”‚
â”‚ 3. ì„±ê³µ:                                                           â”‚
â”‚    - LocalDB.removeLog()                                           â”‚
â”‚    - LocalDB.markNoteSynced()                                      â”‚
â”‚    - note.sync_status = 'synced'                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                        2. ë…¸íŠ¸ ìˆ˜ì • (UPDATE)                            â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ User    â”‚ íƒ€ì´í•‘...
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CodeMirror Editor                                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ EditorView.updateListener                                         â”‚
â”‚   â†’ selectedNote.content = update.state.doc.toString()             â”‚
â”‚   â†’ debouncedUpdate() [1ì´ˆ ë””ë°”ìš´ìŠ¤]                               â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ debouncedUpdate()                                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. content_hash = SHA256(id:title:content:folder_id)              â”‚
â”‚ 2. LocalDB.saveNote(note, 'UPDATE')                                â”‚
â”‚    â€¢ notes store â†’ PUT (dirty)                                     â”‚
â”‚    â€¢ pending_logs â†’ ADD 'UPDATE'                                  â”‚
â”‚ 3. statusMessage = 'Save Complete'                                 â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â”‚ [ë°±ê·¸ë¼ìš´ë“œ]
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ syncWorker()                                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. pending_logsì—ì„œ 'UPDATE' ë¡œê·¸ í™•ì¸                              â”‚
â”‚ 2. PUT /api/notes/{id} {title, content, folder_id}                 â”‚
â”‚ 3. ì„±ê³µ:                                                           â”‚
â”‚    - ë¡œê·¸ ì¤‘ë³µ ì œê±° (CREATE+UPDATE â†’ CREATE)                        â”‚
â”‚    - LocalDB.removeLog()                                           â”‚
â”‚    - LocalDB.markNoteSynced()                                      â”‚
â”‚ 4. ì‹¤íŒ¨ 404:                                                       â”‚
â”‚    - ìê°€ ì¹˜ìœ : POST /api/notesë¡œ ì¬ì‹œë„ (ë³µêµ¬)                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                        3. ë°ì´í„° ë™ê¸°í™” (SYNC)                           â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                          â”‚  App Startâ”‚
                          â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
                                â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚               â”‚               â”‚
                â–¼               â–¼               â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚fetchFolders()â”‚ â”‚ fetchNotes() â”‚ â”‚  Online Event        â”‚
        â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚                â”‚                     â”‚
               â”‚                â”‚                     â–¼
               â”‚                â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
               â”‚                â”‚            â”‚ startSync()     â”‚
               â”‚                â”‚            â”‚  â€¢ syncWorker() â”‚
               â”‚                â”‚            â”‚  â€¢ setInterval  â”‚
               â”‚                â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚                â”‚
               â–¼                â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚           PULL ë‹¨ê³„ (ì„œë²„ â†’ ë¡œì»¬)             â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
        â”‚ 1. GET /api/notes â†’ serverNotes[]          â”‚
        â”‚ 2. ê° noteì— content_hash ê³„ì‚°               â”‚
        â”‚ 3. LocalDB.saveNotesBulk(serverNotes)        â”‚
        â”‚    â”œâ”€ sync_status=='dirty' â†’ ê±´ë„ˆëœ€          â”‚
        â”‚    â”œâ”€ content_hash ì¼ì¹˜ â†’ ê±´ë„ˆëœ€ (ìµœì í™”)    â”‚
        â”‚    â””â”€ ë‚˜ë¨¸ì§€ â†’ PUT (synced)                 â”‚
        â”‚ 4. ì„œë²„ì— ì—†ê³  dirty ì•„ë‹Œ ê²ƒ â†’ DELETE        â”‚
        â”‚ 5. ì¶©ëŒ ê°ì§€:                             â”‚
        â”‚    local.dirty && local.hash != server.hash   â”‚
        â”‚    â†’ enterConflictMode()                    â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚           PUSH ë‹¨ê³„ (ë¡œì»¬ â†’ ì„œë²„)             â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
        â”‚ 1. LocalDB.getPendingLogs()                 â”‚
        â”‚ 2. ë¡œê·¸ ì¤‘ë³µ ì œê±° ë° ì •ë ¬ (í´ë”â†’ë…¸íŠ¸)        â”‚
        â”‚ 3. ê° ë¡œê·¸ ìˆœì°¨ ì „ì†¡:                       â”‚
        â”‚    â€¢ CREATE â†’ POST /api/notes               â”‚
        â”‚    â€¢ UPDATE â†’ PUT /api/notes/{id}           â”‚
        â”‚    â€¢ DELETE â†’ DELETE /api/notes/{id}       â”‚
        â”‚ 4. ì„±ê³µ: removeLog() + markSynced()         â”‚
        â”‚ 5. ì‹¤íŒ¨ 404: ìê°€ ì¹˜ìœ  (PUT â†’ POST)         â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                        4. ì¶©ëŒ í•´ê²° (CONFLICT)                         â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ì¶©ëŒ ê°ì§€ ì¡°ê±´                                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ localNote.sync_status === 'dirty'                               â”‚
â”‚ â€¢ localNote.content_hash !== serverNote.content_hash                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚      enterConflictMode()              â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
        â”‚  conflictState = {                   â”‚
        â”‚    isConflict: true,                  â”‚
        â”‚    localNote: {...},                  â”‚
        â”‚    serverNote: {...}                  â”‚
        â”‚  }                                   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚      MergeView (CodeMirror)           â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
        â”‚  â”‚   Local     â”‚   Server    â”‚      â”‚
        â”‚  â”‚  (Your Edits)â”‚ (Their Version)â”‚   â”‚
        â”‚  â”‚   [A]       â”‚     [B]     â”‚      â”‚
        â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜      â”‚
        â”‚         â”‚             â”‚             â”‚
        â”‚         â–¼             â–¼             â”‚
        â”‚    [Use Local]  [Use Server]        â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚      resolveConflict(action)          â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
        â”‚  'use_local':                        â”‚
        â”‚    â†’ updateNote()                    â”‚
        â”‚    â†’ PUT to server (ê°•ì œ ì „ì†¡)        â”‚
        â”‚                                      â”‚
        â”‚  'use_server':                       â”‚
        â”‚    â†’ localNote = {...serverNote}     â”‚
        â”‚    â†’ LocalDB.saveNote(synced)         â”‚
        â”‚    â†’ UI ì—…ë°ì´íŠ¸                      â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                        5. ì˜¤í”„ë¼ì¸ ì§€ì›                               â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ì˜¨ë¼ì¸ ìƒíƒœ                                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ syncWorker() í™œì„±í™” (5ì´ˆ ê°„ê²©)                                   â”‚
â”‚ â€¢ fetchNotes() ì‹¤í–‰ â†’ ì„œë²„ì™€ ë™ê¸°í™”                                â”‚
â”‚ â€¢ statusMessage = 'Syncing...' â†’ 'Pull Complete'                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ì˜¤í”„ë¼ì¸ ìƒíƒœ                                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ syncWorker() ë¹„í™œì„±í™”                                            â”‚
â”‚ â€¢ ëª¨ë“  CRUDê°€ IndexedDBì—ë§Œ ì €ì¥ (dirty ìƒíƒœ ìœ ì§€)                  â”‚
â”‚ â€¢ pending_logs íì— ê³„ì† ì¶•ì                                       â”‚
â”‚ â€¢ statusMessage = 'Save Complete' (ë¡œì»¬ ì €ì¥ ì™„ë£Œ)                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚      ì˜¨ë¼ì¸ ë³µêµ¬ì‹œ                    â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
        â”‚  window.addEventListener('online')   â”‚
        â”‚    â†’ startSync()                     â”‚
        â”‚    â†’ fetchFolders() + fetchNotes()   â”‚
        â”‚    â†’ ëˆ„ì ëœ ë¡œê·¸ ì „ë¶€ ì „ì†¡ (ë°°ì¹˜)     â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                        6. ê²ŒìŠ¤íŠ¸ ëª¨ë“œ                                 â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ URL: /?mode=guest                                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ localStorage.token = 'guest'                                     â”‚
â”‚ â€¢ currentUserId = 'guest'                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   authenticatedFetch ì¸í„°ì…‰íŠ¸        â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
        â”‚  ëª¨ë“  API ìš”ì²­ì´ guestStoreë¡œ ì²˜ë¦¬:  â”‚
        â”‚                                      â”‚
        â”‚  guestStore = {                      â”‚
        â”‚    user: {id: 'guest', ...},         â”‚
        â”‚    notes: [...],                     â”‚
        â”‚    folders: [...]                    â”‚
        â”‚  }                                   â”‚
        â”‚                                      â”‚
        â”‚  â€¢ IndexedDB ì‚¬ìš© ì•ˆ í•¨               â”‚
        â”‚  â€¢ ì„œë²„ ìš”ì²­ ì•ˆ í•¨                    â”‚
        â”‚  â€¢ ì™„ì „ ì¸ë©”ëª¨ë¦¬                      â”‚
        â”‚  â€¢ ìƒˆë¡œê³ ì¹¨ ì‹œ ë°ì´í„° ì†Œë©¸           â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                        7. ë°ì´í„° ëª¨ë¸ ê´€ê³„                            â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚    User     â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚ id (PK)     â”‚ 1
    â”‚ email       â”‚â”€â”€â”€â”
    â”‚ is_dark_modeâ”‚   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
                      â”‚
                      â”‚ N
                â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”
                â”‚           â”‚
                â–¼           â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  Folder   â”‚ â”‚   Note   â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
        â”‚ id (PK)   â”‚ â”‚ id (PK)   â”‚ N
        â”‚ name      â”‚ â”‚ title     â”‚â”€â”€â”€â”˜
        â”‚ user_id   â”‚ â”‚ content   â”‚
        â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â”‚ folder_idâ”‚ 1
              â”‚       â”‚ user_id   â”‚
              â”‚       â”‚ is_pinned â”‚
              â”‚       â”‚ share_id  â”‚
              â”‚       â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
              â”‚             â”‚
              â”‚ 1           â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    IndexedDB Structure:
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ SHYNOTE_VAULT (v8)                                      â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚                                                          â”‚
    â”‚  notes (ObjectStore)                                     â”‚
    â”‚    â”œâ”€ keyPath: 'id'                                     â”‚
    â”‚    â”œâ”€ indexes: folder_id, updated_at, sync_status, user_idâ”‚
    â”‚    â””â”€ sync_status: 'dirty' | 'synced'                   â”‚
    â”‚                                                          â”‚
    â”‚  folders (ObjectStore)                                   â”‚
    â”‚    â”œâ”€ keyPath: 'id'                                     â”‚
    â”‚    â””â”€ indexes: user_id                                  â”‚
    â”‚                                                          â”‚
    â”‚  pending_logs (ObjectStore)                              â”‚
    â”‚    â”œâ”€ keyPath: 'id' (autoIncrement)                     â”‚
    â”‚    â””â”€ {action, entity, entity_id, payload, created_at}   â”‚
    â”‚                                                          â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ë‹¤ì´ì–´ê·¸ë¨ í‚¤ ì„¤ëª…

| ê¸°í˜¸ | ì˜ë¯¸ |
|-----|------|
| `â”Œâ”€â”€â”€â”€â”€â”` | ì»´í¬ë„ŒíŠ¸/ì»¨í…Œì´ë„ˆ |
| `â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”` | ë°ì´í„° ìŠ¤í† ì–´/í…Œì´ë¸” |
| `â”€â”€â”€â–¶` | ë°ì´í„° íë¦„ (ë‹¨ë°©í–¥) |
| `â—€â”€â”€â”€â–¶` | ë°ì´í„° íë¦„ (ì–‘ë°©í–¥) |
| `â”€â”€â”€â”` `â””â”€â”€â”€` | ë¶„ê¸°/ë³‘í•© |
| `â”‚` | ìˆ˜ì§ ì—°ê²° |
| `â–¼` | ì•„ë˜ë¡œ íë¦„ |
| `â€¢` | ë¦¬ìŠ¤íŠ¸ í•­ëª© |
| `1` `N` | 1:N ê´€ê³„ |

## ìƒ‰ìƒ ì½”ë“œ (í„°ë¯¸ë„ì—ì„œ í‘œì‹œ ì‹œ)

- **íŒŒë€ìƒ‰**: UI/í”„ë¡ íŠ¸ì—”ë“œ ë ˆì´ì–´
- **ë…¹ìƒ‰**: ë¡œì»¬ ë°ì´í„° ì €ì¥ì†Œ (IndexedDB, localStorage)
- **ë…¸ë€ìƒ‰**: ë„¤íŠ¸ì›Œí¬/ë™ê¸°í™” ë ˆì´ì–´
- **ë¹¨ê°„ìƒ‰**: ë°±ì—”ë“œ/ì„œë²„ ë ˆì´ì–´

## ì°¸ê³  íŒŒì¼

- [data_flow_analysis.md](./data_flow_analysis.md) - ìƒì„¸ ë°ì´í„° íë¦„ ë¶„ì„
- [sync_analysis.md](./sync_analysis.md) - ë™ê¸°í™” ì „ëµ ë¶„ì„
- [offline_strategy.md](./offline_strategy.md) - ì˜¤í”„ë¼ì¸ ì§€ì› ì „ëµ
